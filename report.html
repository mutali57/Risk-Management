<!DOCTYPE html>
<html lang="en">
  <head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<meta name="description" content="">
	<meta name="author" content="">

	<!--<link href="css/bootstrap.min.css" rel="stylesheet" />-->
	<link href="css/styles.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link href="https://fonts.googleapis.com/css?family=poppins" rel="stylesheet">

	<link href="css/dashboard.css" rel="stylesheet">
    <!-- Custom styles for this template -->





	<title>Registration Form</title>
<style>
/*
td {
  font-size: 1.5rem;

}
th {

font-size: 15px;
}
#duedelligence {
  height:100px;

}


.panel {
margin-left: 50%;

}
input {

  min-height:10px!important;

  max-height:99.99%!important;
  transition: height 0.001s;

}*/
/*@media (min-width: 480px) {
  th {
  background-color: Red;
    font-size: 11px;
text-align: center;

  }
  td {
    font-size: 10px;

  }

}
*/
@media (min-width: 1200px) {

  td {

    font-size: 1.5rem;

  }
  th {


  font-size: 15px;
  }
  #duedelligence {
    height:100px;

  }


  .panel {
  margin-left: 50%;

  }
  input {

    min-height:10px!important;

    max-height:99.99%!important;
    transition: height 0.001s;

  }






}




</style>
	<!-- <script  src="js/bootstrap.min.js" ></script>-->
  </head>


  <body>
  <!--  <div class ="container">
    <div class ="row">
      <div class="col-md-12">
        <div class="col-md-6">

              <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
            </div>
</div>
  <nav class="navbar navbar-default sticky-top bg-dark flex-md-nowrap p-0">
<div class="col-md-3">
  <a class="navbar-brand" href="#">Company name</a>
</div>
<div class="col-md-6">

      <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
    </div>
      <ul class="navbar-nav">
        <li class="nav-item text-nowrap">
      <button class ="btn btn-primary" onclick="logout();">

      Signout
      </button>
        </li>
      </ul>
    </nav>
  </div>
  </div>

    <div class="container-fluid">
      <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
          <div class="sidebar-sticky">
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link active" href="#">
                  <span data-feather="home"></span>
                  Dashboard <span class="sr-only">(current)</span>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file"></span>
                  Orders
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="shopping-cart"></span>
                  Products
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="users"></span>
                  Customers
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="report.html">
                  <span data-feather="bar-chart-2"></span>
                  Reports
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="layers"></span>
                  Integrations
                </a>
              </li>
            </ul>

            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
              <span>Saved reports</span>
              <a class="d-flex align-items-center text-muted" href="#">
                <span data-feather="plus-circle"></span>
              </a>
            </h6>
            <ul class="nav flex-column mb-2">
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Current month
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Last quarter
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Social engagement
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  <span data-feather="file-text"></span>
                  Year-end sale
                </a>
              </li>
            </ul>
          </div>
        </nav>-->

       <nav class=" navbar navbar-default navbar-fixed-top ">
    <div class="container-fluid">
    <div class ="row">  <!-- Brand and toggle get grouped for better mobile display -->

      <div class="navbar-header">

        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>


        <a class="navbar-brand" href="#">company name</a>
      </div>


      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li class="active"><a href="dash2.html">Home <span class="sr-only">(current)</span></a></li>

          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Risk Assessment <span class="caret"></span></a>
      <ul class="dropdown-menu">

<li><a href="#IntroductionID">Introduction</a></li>
<li><a href="#SiteConditionsID">Site Appreciation</a></li>
<li><a href="#EnergyID">Energy Yield Assessment</a></li>
<li><a href="#ContractOverviewID">Contract Overview</a></li>
<li><a href="#ProgrammeID">Programme</a></li>
<li><a href="#OEMID">OEM and Turbine Technology</a></li>
<li><a href="#BoPID">Balance of Plant Track Record</a></li>
<li><a href="#supplyTurbineID">Supply - Turbine Supply Agreement</a></li>
<li><a href="#SupplyBoPID">Supply - Balance of Plant</a></li>
<li><a href="#SupplyProjectID">Supply - Project Management Agreementt</a></li>
<li><a href="#SupplyInterfaceID">Supply - Interface</a></li>
            </ul>
          </li>
        </ul>

  <div class="navbar-nav">">
          <input class="form-control" id="myInput" type="text" placeholder="Search Table">
  </div>
  <div class="nav navbar-nav navbar-right">
  <button type="submit" class="btn btn-default">Submit</button>
</div>


    </div>




            </div>

    </div><!--
      <div class ="row"></div> /.container-fluid -->

  </nav>




<div id="source-html" class="container-field">

<div row='row'>










<div class= 'col-md-12 col-sm-12' >
<div id="IntroductionID" class="rowclass Introduction "></div>


  <div id="SiteConditionsID" >
    <div class= "rowclass Site_Appreciation"></div>
  </div>

  <div id="EnergyID" >
  <div  class= "rowclass Energy_Analysis"></div>
  </div>

  <div id="SiteConditionsTurbineID" >
  <div class= "rowclass Site_and_Turbine_Suitability"></div>
  </div>


  <div id="ContractOverviewID" >
  <div class = " rowclass Contract_Overview"></div>
  </div>

  <div id="ProgrammeID" >
  <div class= "rowclass Programme"></div>
  </div>

  <div id="OEMID" >
  <div class= "rowclass Original_Equipment_Manufacturer_and_Turbine_Technolog"></div>
  </div>

  <div id="BoPID" >
  <div class= "rowclass Balance_of_Plant_Track_Record"></div>
  </div>

  <div id="SupplyTurbineID" >
  <div class= "rowclass Supply_Turbine_Supply_Agreement"></div>
  </div>


  <div id="SupplyBoPID" >
  <div class= "rowclass Supply_Balance_of_Plant"></div>
  </div>


  <div id="SupplyProjectID" >
  <div class= "rowclass Supply_Project_Management_Agreement"></div>
  </div>



  <div id="SupplyInterfaceID" >
  <div class= "rowclass Supply_Interface"></div>
  </div>




</div>
    </div>
  </div>









		  </div>
<button class='btn  bg-primary' onclick='exportHTML()'>Download</button>
		</div>

		<script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-auth.js"></script>
		<script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-database.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
		<script  src="js/jquery-3.4.1.min.js"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js">
		<script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
<script>
feather.replace();
</script>

<script src="js/auth.js">

</script>
		<script  src="project.js"></script>
<script  src="js/firebase.js">
</script>
		<script  src="js/risk.js"></script>

<script >

var isUpdated=false;



function do_resize(textbox) {


	var maxrows=5;
	var txt=textbox.value;
	var cols=textbox.cols;

	var arraytxt=txt.split('\n');
	var rows=arraytxt.length;

	for (i = 0;i < arraytxt.length;i++)
		rows += parseInt(arraytxt[i].length / cols);

	if (rows > maxrows) textbox.rows = maxrows;
	else textbox.rows = rows;
}


function colorChange (id) {

	$(id).change(function () {
					 if ($(this).val() == "Low")
					 {
						 $(id).css("background-color", "yellow");
					 }
					 else if ($(this).val() == "Medium")
					 {
						 $(id).css("background-color", '#ffa500');

					 }
					 else if ($(this).val() == "High")
					 {
						 $(id).css("background-color", "Red");
					 }
					 else if ($(this).val() == "Negligible")
					 {
						 $(id).css("background-color", "green");
					 }
				 });}
function exportHTML() {
	var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
		"xmlns:w='urn:schemas-microsoft-com:office:word' " +
		"xmlns='http://www.w3.org/TR/REC-html40'>" +
		"<head><meta charset='utf-8'><title>Export HTML to Word Document with JavaScript</title></head><body>";
	var footer = "</body></html>";
	var sourceHTML = header + document.getElementById("source-html").innerHTML + footer;

	var source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
	var fileDownload = document.createElement("a");
	document.body.appendChild(fileDownload);
	fileDownload.href = source;
	fileDownload.download = 'document.doc';
	fileDownload.click();
	document.body.removeChild(fileDownload);
}




function replaceAll(str, find, replace) {
	return str.replace(new RegExp(find, 'g'), replace);
}


function headings(name, topic) {

    var id=name.toLowerCase();

	var page = replaceAll(id, '_', "");

//document.getElementById('productTable').id = name;
	$("." + name).html(createTable(topic, page));
//document.getElementById('productTable').id = name;

	keyRead(name);


}

$(document).ready(function() {

  $("#myInput").on("keyup", function() {
             var value = $(this).val().toLowerCase();
             $("#mytbody tr").filter(function() {
                           $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                         });
           });

					  headings("Introduction", 'Introduction');
					  headings('Site_Appreciation', 'Site Appreciation');
//document.getElementById('productTable').id ="Energy";

					  headings('Energy_Analysis', 'Energy Analysis');

					  headings('Site_and_Turbine_Suitability', 'Site Conditions and Turbine Suitability');
					  headings("Contract_Overview", 'Contract Overview');
					  headings('Programme', "Programme");
					  headings('Balance_of_Plant_Track_Record', "Balance of Plant Track Record");
					  headings("Original_Equipment_Manufacturer_and_Turbine_Technolog", "Original Equipment Manufacturer and Turbine Technolog");
					  headings('Supply_Turbine_Supply_Agreement', "Supply -Turbine Supply Agreement");
					  headings('Supply_Balance_of_Plant', "Supply balance of Plant");
					  headings("Supply_Project_Management_Agreement", "Supply Project Management Agreement");
					  headings("Supply_Interface", "Supply Interface");


					  colorChange("#probabilityscore");
					  colorChange("#severityscore");
					  var      nameid ="";

					  $("table").on("click", function() {



										nameid = $(this).closest('table').attr('id');
										if (typeof(Storage) !== "undefined")
										{
											// Store
											localStorage.setItem("nameid", nameid);

										}
										else
										{
											//document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Storage...";
										}


										var id= nameid.toLowerCase();

										var page = replaceAll(id, '_', "");



										$('#mybutton').on("click", function() {

															  createTable(nameid);
														  });


									});



				  });






</script>

<script>
// Current product being edited
var editRow = null;
var nextId = 1;
// ID of Product currently editing
var activeId = 0;

function productDisplay(ctl) {

	console.log('pressed');
//openForm();

	//alert(row);


	$('#submitContact').text('Update');

	editRow = $(ctl).parents("tr");

	var cols = editRow.children("td");
	activeId = $($(cols[0]).children("button")[0]).data("id");
	//alert(activeId-1);

	$("#heading").val($(cols[1]).text());
	$("#subtopic").val($(cols[2]).text());
	$("#duedelligence").val($(cols[3]).text());
	$("#observation").val($(cols[4]).text());
	$("#severityscore").val($(cols[5]).text());
	$("#severitydescription").val($(cols[6]).text());
	$("#probabilityscore").val($(cols[7]).text());
	$("#probabilitydescription").val($(cols[8]).text());
	$("#suggestion").val($(cols[11]).text());



	// Change Update Button Text

}

function productUpdate() {

//alert ($("#submitContact").text());
	if ($("#submitContact").text() == 'Update')
	{

        productUpdateInTable(activeId);

	}
	else

	{


		productAddToTable();






	}

	// Clear form fields


	// Focus to product name field
	$("#subtopic").focus();

}

// Add product to <table>
function productAddToTable() {
	;



	// First check if a <tbody> tag exists, add one if not
	if ($("#productTable tbody").length == 0)
	{

        $("#productTable").append("<tbody id='mytbody'></tbody>");
	}


	// Append product to table

	$("#productTable tbody").append(productBuildTableRow(nextId));
	nextId += 1;
}

// Update product in <table>
function productUpdateInTable(id) {

	var row = $("#productTable button[data-id='" + id + "']")
		.parents("tr")[0];

	// Add changed product to table
	$(row).after(productBuildTableRow(id));

	// Remove original product
	$(row).remove();

	// Clear form fields

	// Change Update Button Text
//$("#submitContact").text("Add");
}
var j=0;
// Build a <table> row of Product data
function productBuildTableRow(id) {
	var ret ;
	if (valList.length < 3)
	{

		ret = "<tr>" +
			"<td>" +
			"<button type='button' class='btn btn-info btn-lg' data-toggle='modal'  data-target='#myModal'" +
			"onclick='productDisplay(this);' " +
			"class='btn btn-default'" +
			"data-id='" + id + "'>" +
			"<span class='glyphicon glyphicon-edit' />" +
			"</button>" +
			"<td>" + valList[0] + "</td>"  +
			"<td>" + valList[1] + "</td>" +


			"</tr>";


	}
	else
	{

		//alert(valList[1]);

		//alert(valList[1]=="")
		if (snapData.heading == '')
		{
//alert(valList[6]);

			ret = "<tr>" +
				"<td>" +
				"<td>" + "</td>"   +
  			"<td>" + snapData.subtopic + "</td>"  +
  			"<td>" + snapData.duedelligence + "</td>" +
  			"<td>"  + snapData.observation + "</td>" +
  			"<td class='"+snapData.severityscore+"'>" + snapData.severityscore + "</td>" +
  			"<td>" + snapData.severitydescription + "</td>" +
  			"<td class='"+snapData.probabilityscore+"'>" + snapData.probabilityscore + "</td>" +
  			"<td><p>" + snapData.probabilitydescription + "</p></td>" +
  			"<td>" + riskScore() + "</td>" +
  			"<td class='"+risk(riskScore())+"'><strong>" + risk(riskScore()) + "</strong></td>" +
  			"<td>" + snapData.suggestion + "</td>" +
  			"</tr>";

			RiskArray[j] = riskScore(),
				j++;

		}
		else
		{
			ret = "<tr>" +
				"<td>" +
				"<button type='button' id='edit'" +
				"onclick='productDisplay(this);' " +
				"class='btn btn-default'" +
				"data-id='" + id + "'>" +
				"<span class='glyphicon glyphicon-edit' />" +
				"</button>" +
				"</td>" +
				"</td><td class='Subtopic'> <strong>" + snapData.heading + "<strong/></td>" +

				"</tr>" ;
		}
	}


	return ret;
}

// Delete product from <table>



</script>
	 </body>
</html>
